# 🚀 راهنمای بهینه‌سازی - دوبله خودکار ویدیو

## ⚡ تنظیمات بهینه‌سازی شده

### 🔧 تغییرات اعمال شده:

#### 1. **مدیریت هوشمند محدودیت‌های API**:
- ⏱️ **زمان انتظار**: از 9 ثانیه به 30 ثانیه افزایش یافت
- 📦 **پردازش Batch**: سگمنت‌ها در گروه‌های 3 تایی پردازش می‌شوند
- ⏳ **تاخیر بین Batch ها**: 60 ثانیه انتظار بین هر batch
- 🔄 **تلاش‌های بیشتر**: از 3 به 5 تلاش افزایش یافت

#### 2. **فشرده‌سازی خودکار**:
- 📊 **فشرده‌سازی پیش‌فرض**: از 3 به 5 افزایش یافت
- 🤖 **فشرده‌سازی خودکار**: برای ویدیوهای طولانی فعال می‌شود
- 📈 **حداکثر فشرده‌سازی**: تا 15 دیالوگ در هر گروه

#### 3. **مدیریت خطاهای بهتر**:
- 🛡️ **مدیریت فایل‌های خالی**: فایل‌های سکوت به عنوان جایگزین
- 📝 **لاگ‌های بهتر**: اطلاعات دقیق‌تر از فرآیند
- ⚠️ **هشدارهای هوشمند**: اطلاع‌رسانی محدودیت‌ها

## 📋 راهنمای استفاده بهینه:

### 🎯 برای ویدیوهای کوتاه (کمتر از 5 دقیقه):
```
✅ تنظیمات پیشنهادی:
- فشرده‌سازی: 3-5 دیالوگ
- زمان انتظار: 30 ثانیه
- مدل: gemini-2.5-flash-preview-tts
```

### 🎯 برای ویدیوهای متوسط (5-15 دقیقه):
```
✅ تنظیمات پیشنهادی:
- فشرده‌سازی: 5-8 دیالوگ
- زمان انتظار: 45 ثانیه
- مدل: gemini-2.5-flash-preview-tts
```

### 🎯 برای ویدیوهای طولانی (بیش از 15 دقیقه):
```
✅ تنظیمات پیشنهادی:
- فشرده‌سازی: 8-15 دیالوگ (خودکار)
- زمان انتظار: 60 ثانیه
- مدل: gemini-2.5-flash-preview-tts
- ⚠️ ممکن است نیاز به API پولی باشد
```

## 🔍 تشخیص مشکلات:

### ❌ خطای "Quota exceeded":
```
🔧 راه‌حل‌ها:
1. زمان انتظار را افزایش دهید (60+ ثانیه)
2. فشرده‌سازی را بیشتر کنید
3. ویدیوی کوتاه‌تر انتخاب کنید
4. فردا دوباره امتحان کنید (reset quota)
```

### ❌ خطای "فایل صوتی خالی":
```
🔧 راه‌حل‌ها:
1. زمان انتظار را افزایش دهید
2. مدل TTS را تغییر دهید
3. متن را بررسی کنید (ممکن است مشکل داشته باشد)
```

### ❌ خطای "ویدیو خصوصی":
```
🔧 راه‌حل‌ها:
1. از ویدیوهای عمومی استفاده کنید
2. کوکی‌های مرورگر را اضافه کنید
3. ویدیوی دیگری انتخاب کنید
```

## 📊 آمار عملکرد:

### ⚡ سرعت پردازش:
- **ویدیوی 5 دقیقه‌ای**: ~10-15 دقیقه
- **ویدیوی 10 دقیقه‌ای**: ~25-35 دقیقه
- **ویدیوی 15 دقیقه‌ای**: ~40-60 دقیقه

### 💰 مصرف API:
- **رایگان**: حداکثر 15 درخواست/روز
- **پولی**: بدون محدودیت (پرداخت بر اساس استفاده)

## 🎛️ تنظیمات پیشرفته:

### 🔧 در فایل config.py:
```python
"tts": {
    "sleep_between_requests": 30,  # زمان انتظار
    "batch_size": 3,              # اندازه batch
    "batch_delay": 60,            # تاخیر بین batch ها
    "max_retries": 5              # تعداد تلاش‌ها
}
```

### 🔧 در رابط کاربری:
- زمان انتظار: 10-60 ثانیه
- فشرده‌سازی: 3-15 دیالوگ
- مدل TTS: انتخاب از دو گزینه

## 🚀 نکات بهینه‌سازی:

1. **⏰ زمان‌بندی**: بهترین زمان استفاده صبح‌ها است (quota تازه reset شده)
2. **📹 انتخاب ویدیو**: ویدیوهای کوتاه و با کیفیت صوتی خوب
3. **🎤 تنظیمات صدا**: از پرامپت‌های ساده استفاده کنید
4. **🔄 صبر**: فرآیند ممکن است طولانی باشد، صبور باشید

## 📞 پشتیبانی:

در صورت بروز مشکل:
1. لاگ‌ها را بررسی کنید
2. تنظیمات را بهینه کنید
3. ویدیوی کوتاه‌تر امتحان کنید
4. API پولی در نظر بگیرید

---

**🎬 با این تنظیمات بهینه‌سازی شده، برنامه بهتر با محدودیت‌های API رایگان کار می‌کند!**
